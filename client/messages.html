<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="./libs/bootstrap.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./loader.css">
    <link rel="stylesheet" href="./font.css">
    <script src="./libs/jquery-1.4.4.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@1,300;1,400&display=swap" rel="stylesheet">
    <!-- <link rel="preconnect" href="./loader.css"> -->

    <title>messages</title>
    <style>
        #no__message {
            width: min(300px, calc(100% - 40px));
            height: 300px;
            margin: 0 auto;
        }
        
        .__loader {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 202;
            margin: 0;
            padding: 0;
            opacity: 1;
            /* background-image: linear-gradient(to right, pink, rgba(255, 0, 0, 0), pink); */
            /* background-color: rgb(219, 196, 200); */
        }
        
        .bigDiv {
            position: relative;
            /* width: 200px; */
            height: 20px;
            /* border: 1px solid yellow; */
        }
        
        .smallDivs {
            width: 5px;
            height: 80%;
            background-color: orange;
            display: inline-block;
            position: relative;
            border-radius: 2px 2px 0px 0px;
            margin: 0px;
        }
        
        .bigDiv .smallDivs:nth-child(1) {
            animation-name: loader;
            animation-duration: 1s;
            animation-iteration-count: infinite;
            animation-direction: alternate-reverse;
        }
        /* ending  here */
        
        .bigDiv .smallDivs:nth-child(2) {
            animation-name: loader;
            animation-duration: 1.5s;
            animation-iteration-count: infinite;
            animation-direction: alternate-reverse;
        }
        
        .bigDiv .smallDivs:nth-child(3) {
            animation-name: loader;
            animation-duration: 2s;
            animation-iteration-count: infinite;
            animation-direction: alternate-reverse;
        }
        
        .bigDiv .smallDivs:nth-child(4) {
            animation-name: loader;
            animation-duration: 2.5s;
            animation-iteration-count: infinite;
            animation-direction: alternate-reverse;
        }
        
        .bigDiv .smallDivs:nth-child(5) {
            animation-name: loader;
            animation-duration: 1.25s;
            animation-iteration-count: infinite;
            animation-direction: alternate-reverse;
        }
        
        .bigDiv .smallDivs:nth-child(6) {
            display: inline-block;
            opacity: 0;
        }
        
        @keyframes loader {
            0% {
                height: 80%;
                background-color: gray
            }
            100% {
                height: 10%;
                background-color: indigo;
            }
        }
    </style>
</head>


<body>

    <!-- loader -->





    <!-- end of loader -->


    <!-- modal 2X -->

    <div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center" id="feed">
                    thanks for sending your feedback <br>
                </div>
                <div class="modal-footer">
                    <!-- <button class="btn btn-primary" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"></button> -->
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel2">please send us your feedback</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-body">
                        <form>
                            <div class="mb-3">
                                <label for="recipient-name" class="col-form-label">Email Address:</label>
                                <input type="email" required="true" class="form-control" id="recipient-name">
                            </div>
                            <div class="mb-3">
                                <label for="message-text" class="col-form-label">Message:</label>
                                <textarea class="form-control" id="message-text"></textarea>
                            </div>
                        </form>
                    </div>

                    <!-- Hide this modal and show the first with the button below. -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal" id="submitBtn">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <a class="btn btn-primary" data-bs-toggle="modal" href="#exampleModalToggle" role="button">Open first modal</a>
    <!-- end of modal 2X -->
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark position-fixed top-0 w-100 pb-3" style="z-index: 200;">
        <div class="container">
            <a href="" class="navbar-brand text-danger fs-2" style="color:pink!important">Secret Message</a>
            <div class="navbar-toggler border-0">
                <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">

<div class="span navbar-toggler-icon"></div>
                </button>

            </div>

            <div class="collapse navbar-collapse " id="navmenu">
                <ul class="navbar-nav ms-auto">

                    <li class="nav-item">
                        <button type="button" class="bg-dark text-secondary nav-link border-none fw-bolder btn btn-outline-dark" style="color:pink!important" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                             Logout
                              </button>
                    </li>
                    <li class="nav-item">
                        <a href="./about.html" class="nav-link" style="color:pink!important">About</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- menu here  -->
        <div class="scroll-container position-absolute  w-100 bg-success" id="scroll_container" style="bottom: 0;">
            <div class=" p-1 bg-danger " id="scroll">

            </div>
        </div>

    </nav>



    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-danger fs-2 text-capitalize" id="staticBackdropLabel">watchout</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Please before you log out ,take screenshots of your logging details
                    <button class=" fw-light btn btn-link" data-bs-dismiss="modal" onclick="alert_()">here</button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="logout" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- end of modal here -->

    <div class="container py-5 ">
        <div class="user-info  rounded-top bg-white shadow rounded-3" style="margin-top:10rem">
            <div class=" row justify-content-between py-5 g-4 gx-4 px-4">
                <div class=" col-md col-sm p-0">
                    <div class="d-flex gap-1 text-center justify-content-center overflow-hidden flex-column">
                        <button type="button" class="btn btn-outline-secondary" style="font-size:0.8rem" id="link"></button>
                        <div id="copy_" class="btn-lg btn-primary w-100"><span><i class="fa-regular fa-copy"></i></span>&nbsp;copy link </div>
                    </div>
                </div>
                <div class="col-md  rounded-1 d-flex gap-1  overflow-hidden flex-column p-0 mx-1" id="logindetails">
                    <span>  <div id="user-id" class="fw-bolder btn btn-outline-warning w-100">ID : &nbsp;</div></span>
                    <span>  <div id="password" class="fw-bolder fw-bolder btn btn-outline-dark w-100">Password : &nbsp;</div></span>
                </div>
                <div class="col-md-12">

                    <span>  <a  id="addtows" class="fw-bolder font-montserrat fw-bolder btn btn-success w-100 py-2"
                         href="whatsapp://send?text="
                        data-action="share/whatsapp/share"
                        target="_blank">Add to whatsapp</a></span>
                </div>
            </div>
        </div>
    </div>
    <div class="reload
    position-fixed  p-2 bg-success shadow rounded top-50 d-flex gap-1 refreshBtn" style="z-index: 201;right:10px">
        refreesh page
        <div class="bigDiv d-none">
            <div class="smallDivs "></div>
            <div class="smallDivs "></div>
            <div class="smallDivs "></div>
            <div class="smallDivs "></div>
            <div class="smallDivs "></div>
            <div class="smallDivs "></div>
        </div>
    </div>
    <h2 id="name" style="z-index:20" class="text-center bg-dark text-danger text-uppercase p-3 mt-0 mb-5">Name</h2>

    <div class="row">
        <div class="col-md-10 col-lg-6  m-auto   d-flex justify-content-center align-items-center">
            <div class="row" id="img_container" style="perspective: 100px;">
            </div>
        </div>
    </div>
    <div class="loader-container">
        <div class="loader">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <h2 class="text-center fs-1 text-success fw-bolder ismessage" id="message_header">Messages</h2>


    <div class="container">

        <div class="message-box row g-4 pb-4">

        </div>
    </div>
    <div class="container">
        <div class="accordion accordion-flush py-4" id="accordionFlushExample">
            <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingOne">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                  Accordion Item #1
                </button>
                </h2>
                <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                    <div class="accordion-body">Placeholder content for this accordion, which is intended to demonstrate the <code>.accordion-flush</code> class. This is the first item's accordion body.</div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                  Accordion Item #2
                </button>
                </h2>
                <div id="flush-collapseTwo" class="accordion-collapse collapse" aria-labelledby="flush-headingTwo" data-bs-parent="#accordionFlushExample">
                    <div class="accordion-body">Placeholder content for this accordion, which is intended to demonstrate the <code>.accordion-flush</code> class. This is the second item's accordion body. Let's imagine this being filled with some actual content.</div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                  Accordion Item #3
                </button>
                </h2>
                <div id="flush-collapseThree" class="accordion-collapse collapse" aria-labelledby="flush-headingThree" data-bs-parent="#accordionFlushExample">
                    <div class="accordion-body">Placeholder content for this accordion, which is intended to demonstrate the <code>.accordion-flush</code> class. This is the third item's accordion body. Nothing more exciting happening here in terms of content, but just filling up
                        the space to make it look, at least at first glance, a bit more representative of how this would look in a real-world application.</div>
                </div>
            </div>
        </div>
    </div>
    <footer class="bg-dark text-center text-white">
        <!-- Grid container -->
        <div class="container p-4 pb-0">
            <!-- Section: Social media -->
            <section class="mb-4">
                <!-- Facebook -->
                <a class="btn text-white btn-floating m-1" style="background-color: #3b5998;" href="https://web.facebook.com/profile.php?id=100049841954100" role="button"><i class="fab fa-facebook-f"></i
            ></a>

                <!-- Twitter -->
                <a class="btn text-white btn-floating m-1" style="background-color: #55acee;" href="" role="button"><i class="fab fa-twitter"></i
            ></a>

                <!-- Google -->
                <a class="btn text-white btn-floating m-1" mailto="bateemma14gmail.com" href="" style="background-color: #dd4b39;" role="button"><i class="fab fa-google"></i
            ></a>

                <!-- Instagram -->
                <a class="btn text-white btn-floating m-1" style="background-color: #ac2bac;" href="" role="button"><i class="fab fa-instagram"></i
            ></a>

                <!-- Linkedin -->
                <a class="btn text-white btn-floating m-1" style="background-color: #0082ca;" href="" role="button"><i class="fab fa-linkedin-in"></i
            ></a>
                <!-- Github -->
                <a class="btn text-white btn-floating m-1" style="background-color: #333333;" href="https://github.com/Abate-Mony" role="button"><i class="fab fa-github"></i
            ></a>
            </section>
            <!-- Section: Social media -->
        </div>
        <!-- Grid container -->

        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2020 Copyright:
            <a class="text-white" href="https://mdbootstrap.com/">MDBootstrap.com</a>
        </div>
        <!-- Copyright -->
    </footer>
    <script src="./__messages.js"></script>
    <script>
        const messageBox = document.querySelector(".message-box")
        const isUser = sessionStorage.getItem("login")
        const id = location.search.substring(1)

        function logout() {
            location.replace("./index.html")
            sessionStorage.removeItem("login")
            sessionStorage.removeItem("token")
        }



        function fadeOut() {
            const _last_index = document.getElementById("_last_index")
            const scroll = $("#scroll")[0]
            const cards = [...document.querySelectorAll("._card")]
            const _off_top = _last_index.offsetTop
            const _scroll = window.pageYOffset + window.innerHeight
            const _percent = (_scroll / _off_top) * 100
            scroll.style.width = `${_percent}%`
            const H = (window.innerHeight / 100) * 90
            cards.forEach((_, __) => {
                const _top = _.getBoundingClientRect().top;
                if (_top <= H) {
                    $(_).addClass("opacity");
                } else {
                    $(_).css("opacity", "0");
                    $(_).removeClass("opacity");
                }
            })
        }

        function _scroll(e) {
            fadeOut()
        }
        window.addEventListener("scroll", e => {
            _scroll()
            const scrollHeight = window.pageYOffset
            const navbarHeight = $(".navbar")[0].getBoundingClientRect().height
            const nameHeight = $("#name")[0].offsetTop
            if (scrollHeight >= nameHeight - 50) {
                $("#name").addClass("position-fixed w-100").css({
                    "top": navbarHeight
                })
            } else {
                $("#name").removeClass("position-fixed")
            }

        })
        if (isUser) {

            document.getElementById("addtows").href += location.href



            socket.addEventListener("open", function(event) {
                console.log("connected to web server thanks for everythng")
            })
            socket.addEventListener("message", function(event) {
                console.log("message form servers ", event.data)
                const _id = event.data
                if (isUser == _id) {
                    Messages()
                }
            })


            function alert_() {
                $(document).scrollTop(0);
                $("#logindetails").addClass("_alert");
                setTimeout(() => {
                    $("#logindetails").removeClass("_alert");
                }, 4000);
            }
            const href = location.href
        } else {
            location.href = `./message.html?${id}`
        }
    </script>
    <script>
        window.addEventListener("load", () => {
            $(".refreshBtn").click(function(e) {
                const div = this.querySelector(".bigDiv")
                div.classList.remove("d-none")
                location.reload()
            })
            const submitBtn = document.getElementById("submitBtn")
            let headersList = {
                "Accept": "*/*",
                "Authorization": `pablo ${token}`,
                "Content-Type": "application/json"
            }

            submitBtn && submitBtn.addEventListener("click", async(e) => {
                const feed = document.getElementById("feed")
                const UserInfo = {
                    Email: $("#recipient-name").val(),
                    Message: $("#message-text").val()
                }
                const response = await fetch("/api/v1/feedback", {
                    headers: headersList,
                    method: "post",
                    body: JSON.stringify(UserInfo)
                })
                if (!response.ok) {
                    // console.log(response)
                    feed.classList.add("text-danger")
                    feed.textContent = "something went wrong 😯"
                    setTimeout(() => {
                        feed.classList.remove("text-danger")
                        feed.textContent = "thanks for sending your feedback <br> we appreciate 😎"

                    }, 2000);
                    return
                } else {
                    console.log(response)
                }

            })
        })
    </script>
    <script async src="./libs/bootstrap.bundle.min.js"></script>
    <span id="_last_index"></span>
</body>

</html